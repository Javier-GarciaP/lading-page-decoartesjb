const d=window.matchMedia("(prefers-reduced-motion: reduce)").matches;class f{canvas;ctx=null;particles=[];mouseX=0;mouseY=0;width=0;height=0;animationFrame=0;constructor(){this.canvas=document.getElementById("particles-canvas"),!(!this.canvas||d)&&(this.ctx=this.canvas.getContext("2d",{alpha:!0}),this.init(),this.animate(),this.handleEvents())}init(){this.resize();const i=window.innerWidth<768?40:80;for(let t=0;t<i;t++){const s=["circle","star","heart","sparkle","flower"],a=s[Math.floor(Math.random()*s.length)],o=Math.floor(Math.random()*3);this.particles.push(new m(this.width,this.height,a,o))}}resize(){this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height}handleEvents(){window.addEventListener("resize",()=>{this.resize(),this.particles=[],this.init()}),window.addEventListener("mousemove",e=>{this.mouseX=e.clientX,this.mouseY=e.clientY}),window.addEventListener("touchmove",e=>{e.touches.length>0&&(this.mouseX=e.touches[0].clientX,this.mouseY=e.touches[0].clientY)})}animate(){this.ctx&&(this.ctx.clearRect(0,0,this.width,this.height),this.particles.sort((e,i)=>e.layer-i.layer),this.particles.forEach(e=>{e.update(this.width,this.height,this.mouseX,this.mouseY),this.ctx&&e.draw(this.ctx)}),this.animationFrame=requestAnimationFrame(()=>this.animate()))}destroy(){cancelAnimationFrame(this.animationFrame)}}class m{x;y;size;speedX;speedY;baseAlpha;alpha;phase;type;layer;rotation;rotationSpeed;color;flowerType;constructor(e,i,t,s){this.x=Math.random()*e,this.y=Math.random()*i,this.type=t,this.layer=s;const a=1+(2-s)*.3;this.size=(Math.random()*2+1)*a;const o=1+(2-s)*.2;if(this.speedX=(Math.random()*.6-.3)*o,this.speedY=(Math.random()*.6-.3)*o,this.baseAlpha=(Math.random()*.3+.2)*(1-s*.2),this.alpha=this.baseAlpha,this.phase=Math.random()*Math.PI*2,this.rotation=Math.random()*Math.PI*2,this.rotationSpeed=t==="flower"?(Math.random()-.5)*.01:(Math.random()-.5)*.02,t==="flower"){const h=["rose","tulip","daisy"];this.flowerType=h[Math.floor(Math.random()*h.length)]}if(t==="flower"){const h=["rgba(255, 182, 193, ","rgba(216, 191, 216, ","rgba(255, 255, 255, ","rgba(255, 105, 180, ","rgba(255, 240, 245, "];this.color=h[Math.floor(Math.random()*h.length)]}else{const h=["rgba(212, 175, 55, ","rgba(244, 228, 180, ","rgba(255, 215, 0, ","rgba(218, 165, 32, "];this.color=h[Math.floor(Math.random()*h.length)]}}update(e,i,t,s){this.x+=this.speedX,this.y+=this.speedY,this.rotation+=this.rotationSpeed,this.x>e+50?this.x=-50:this.x<-50&&(this.x=e+50),this.y>i+50?this.y=-50:this.y<-50&&(this.y=i+50),this.phase+=.015+(2-this.layer)*.005,this.alpha=this.baseAlpha+Math.sin(this.phase)*this.baseAlpha*.5;const a=this.x-t,o=this.y-s,h=Math.sqrt(a*a+o*o),r=120+this.layer*30;if(h<r&&h>0){const l=a/h,w=o/h,n=(r-h)/r*(3-this.layer);this.x+=l*n*1.5,this.y+=w*n*1.5}}draw(e){switch(e.save(),e.globalAlpha=this.alpha,e.translate(this.x,this.y),e.rotate(this.rotation),this.type){case"circle":this.drawCircle(e);break;case"star":this.drawStar(e);break;case"heart":this.drawHeart(e);break;case"sparkle":this.drawSparkle(e);break;case"flower":this.drawFlower(e);break}e.restore()}drawCircle(e){e.beginPath(),e.fillStyle=this.color+this.alpha+")",e.arc(0,0,this.size,0,Math.PI*2),e.fill(),e.shadowBlur=this.size*2,e.shadowColor=this.color+this.alpha*.5+")"}drawStar(e){const t=this.size,s=this.size*.8;e.beginPath();for(let a=0;a<5*2;a++){const o=a%2===0?t:s,h=Math.PI/5*a,r=Math.cos(h)*o,l=Math.sin(h)*o;a===0?e.moveTo(r,l):e.lineTo(r,l)}e.closePath(),e.fillStyle=this.color+this.alpha+")",e.fill()}drawHeart(e){const i=this.size;e.beginPath(),e.moveTo(0,i*.3),e.bezierCurveTo(-i,-i*.3,-i*.5,-i,0,-i*.3),e.bezierCurveTo(i*.5,-i,i,-i*.3,0,i*.3),e.closePath(),e.fillStyle=this.color+this.alpha+")",e.fill()}drawSparkle(e){const i=this.size;e.beginPath(),e.moveTo(-i,0),e.lineTo(i,0),e.moveTo(0,-i),e.lineTo(0,i),e.strokeStyle=this.color+this.alpha+")",e.lineWidth=i*.3,e.lineCap="round",e.stroke(),e.beginPath();const t=i*.7;e.moveTo(-t,-t),e.lineTo(t,t),e.moveTo(t,-t),e.lineTo(-t,t),e.stroke()}drawFlower(e){switch(this.flowerType){case"rose":this.drawRose(e);break;case"tulip":this.drawTulip(e);break;case"daisy":this.drawDaisy(e);break}}drawRose(e){const i=this.size;for(let t=0;t<3;t++){const s=i*(1-t*.25),a=5;for(let o=0;o<a;o++){const h=Math.PI*2*o/a+t*Math.PI/a;e.save(),e.rotate(h),e.beginPath(),e.ellipse(0,s*.5,s*.6,s*.8,0,0,Math.PI*2),e.fillStyle=this.color+this.alpha*(.8-t*.2)+")",e.fill(),e.restore()}}e.beginPath(),e.arc(0,0,i*.3,0,Math.PI*2),e.fillStyle="rgba(255, 223, 0, "+this.alpha*.6+")",e.fill()}drawTulip(e){const i=this.size,t=6;for(let s=0;s<t;s++){const a=Math.PI*2*s/t;e.save(),e.rotate(a),e.beginPath(),e.moveTo(0,0),e.quadraticCurveTo(i*.3,-i*.5,0,-i),e.quadraticCurveTo(-i*.3,-i*.5,0,0),e.fillStyle=this.color+this.alpha+")",e.fill(),e.restore()}}drawDaisy(e){const i=this.size,t=8;for(let s=0;s<t;s++){const a=Math.PI*2*s/t;e.save(),e.rotate(a),e.beginPath(),e.ellipse(0,i*.7,i*.35,i*.6,0,0,Math.PI*2),e.fillStyle=this.color+this.alpha+")",e.fill(),e.restore()}e.beginPath(),e.arc(0,0,i*.4,0,Math.PI*2),e.fillStyle="rgba(255, 215, 0, "+this.alpha+")",e.fill()}}let p=null;document.addEventListener("DOMContentLoaded",()=>{d||(p=new f)});window.addEventListener("beforeunload",()=>{p?.destroy()});
